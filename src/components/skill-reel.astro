---
import SkillBox from "./skill-box.astro";
import Next from "./next.astro";
import { skills } from "../pages/api/skills.ts";
const idList = skills.map((skill) => skill.id);
---

<div class='skill-reel' data-skillids={idList}>
  <Next next='false' />
  {
    (skills ?? []).map((skill, index) => {
      return (
        <SkillBox
          id={skill.id}
          title={skill.title}
          description={skill.description}
          skills={skill.skills}
          active={index === 0}
        />
      );
    })
  }
  <Next next='true' />
</div>
<script define:vars={{ ids: idList }}>
  document.addEventListener("DOMContentLoaded", (event) => {
    const elements = ids.map((id) => document.getElementById(id));
    let current = 0;

    const next = document.getElementById("next-button-next").addEventListener("click", () => {
      const nextElement = current + 1 > elements.length - 1 ? 0 : current + 1;
      elements[current].classList.remove("active");
      elements[current].classList.add("inactive");
      elements[nextElement].classList.add("active");
      elements[nextElement].classList.remove("inactive");
      current = nextElement;
    });

    const previous = document.getElementById("next-button-previous").addEventListener("click", () => {
      const nextElement = current - 1 < 0 ? 2 : current - 1;
      elements[current].classList.remove("active");
      elements[current].classList.add("inactive");
      elements[nextElement].classList.add("active");
      elements[nextElement].classList.remove("inactive");
      current = nextElement;
    });
  });
</script>
<style>
  .skill-reel {
    display: flex;
    flex-direction: row;
    align-items: flex-start;
    justify-content: center;
    width: 100%;
    height: 100%;
  }
</style>
